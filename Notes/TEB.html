<p>原理</p><ul><li>建立数学模型，原问题转化为有终末条件，以位姿，时间为变量，以避障，速度为约束的最优化问题，优化目标为时间，或者驾驶通行难度，或者综合。</li><li>求解最优化问题上，采用了化约束为惩罚的软约束策略，将问题转化为无约束的稀疏带状线性矩阵优化问题，采取梯度下降法求解。</li><li>求解约束后，要验证其feasibility可行性。对于可行性较差的方案，在不添加可行性目标的情况下，难以实现启发式针对性优化。</li></ul><attachment contenteditable="false" data-atts="%5B%5D" data-aid=".atts-3d007476-92ca-4826-ae9c-f79e717b00b3"></attachment><p>算法</p><ul><li><br></li><li>LM优化算法</li><li>软约束策略</li><li>速度目标函数</li><li>图优化方法主要的优化方向，构建图，构建边（约束）。</li><li>整理teb算法的基本流程，并对其进行优化。</li><li>就目前teb的整体流程来看。teb更适合于局部路径的优化，使其满足运动学，动力学约束，靠右行走或这其他。由于热启动的存在，可以采用其他的算法对teb优化的初始路径进行预热。</li></ul><p>teb local planner框架总结与梳理</p><ul><li>TebLocalPlannerROS：ros框架下的局部规划器的控制层</li><li class="ql-indent-1">配置与ros节点的通讯，获取costmap，全局地图，发布速度。</li><li class="ql-indent-1">获取costmap，实时解算obstacle</li><li class="ql-indent-1">获取位姿，当前速度。</li><li class="ql-indent-1">解算速度命令</li><li>TimedElasticBand：规划路径对象，数据结构</li><li class="ql-indent-1"> trajectory对象，为Pose(vel,diff time)容器</li><li class="ql-indent-1">增删Pose</li><li class="ql-indent-1">init，autoresize，update等操作。TEB对象作为g2o的优化对象，init初始化出一条起终点的直线路径；autoresize，当路径点过多过少时，将路径点均匀平衡;update，当局部规划变化，调整路径。</li><li class="ql-indent-1">路径的一些函数。</li><li>HomotopyClassPlanner：同伦类路径规划器</li><li class="ql-indent-1">同伦类路径规划的意义在于搜索所有局部的相对全局同伦类路径，分别对他们进行规划。解决陷入局部最优的问题。同时，不会出现原方法的“烂规划”问题，规划效果不能再优化。</li><li class="ql-indent-1">根本策略为对每一个障碍物，分左绕行和右绕行推演拓扑路径，并在每个拓扑路径的同伦类中优化选择最优路径。</li><li class="ql-indent-1">算力要求较高，无效算力比例较大。部分步骤可进一步优化，算法泛化浪费较大。</li><li>TebOptimalPlanner：路径规划器</li><li class="ql-indent-1">考虑到目前teb算法的真正的职责是优化路径，其能够添加动力学约束，局部规划的范围较小。障碍物结构并不十分复杂。因此，标准的求解器基本能够满足条件。</li><li class="ql-indent-1">添加图优化点和边，构建优化图。图的构建可以较为灵活，可以将优化中的非线性问题转移到图的构建中。</li><li class="ql-indent-1">对外提供plan接口，对内实现graph控制。</li><li class="ql-indent-1">优化图。采用热启动策略，以上次优化的结果作为本次优化的起点，减小迭代次数，但同时易陷入局部最优。循环，并一次减小梯度下降步长，实现优化。</li><li class="ql-indent-1">检测路径是否合法的函数。根据规则判断路径是否好，否则进一步优化，或者上报路径规划失败。</li><li class="ql-indent-1">判断是否没有收敛，判断收敛步的马氏距离。</li><li>Edge：图优化边</li><li class="ql-indent-1">定义边</li><li class="ql-indent-1">定义cost函数</li><li class="ql-indent-1">定义雅克比矩阵，用于矩阵下降(不定义则采用默认求导器)。目前尚不清楚采用雅克比与否对求解速度影响。</li><li>g2o sparse optimizer：</li><li class="ql-indent-1">线性约束稀疏优化器。一个常用的求解器。</li></ul><p><br></p><p>优化</p><ul><li>专利：平稳驾驶图优化算法。减少图优化算法消耗，提高控制特性，专利必须尽快提上日程，并将其转化为工程实际。</li><li>关于优化位姿数量的生成与初始优化位姿</li><li>暖启动，用dwa规划的路径来暖启动teb，或者更快速的方法</li><li>泊车路径规划。可参考自动驾驶。</li><li>可行性目标函数</li><li>使用优化器的流程，与逻辑。</li><li><br></li></ul><p>tips</p><p><br></p><ul><li>蠕动规划的路径。</li><li>规划中的运动与实际严重不符。执行机构拉跨。</li><li><em><u>转速度速度控制为运动步控制</u></em></li><li><em><u>电机控制可以检测输出转矩，控制量由速度上升到加速度</u></em></li><li>基于执行机构的三维度路径规划，位移，速度，加速度。三个维度有对立性矛盾，或者递进式关系。位移规划最模糊，最易执行，若以执行有限，以流畅为规划目标，则可。速度，能够控制机器人运动的总体趋势，难以准确执行，需要对执行机构进行预测。以加速度控制为主，规划最精细，最难以执行，但若能结合反馈，机器人运行最平稳。</li><li>需要考虑动态环境的实时局部路径规划，预先路径无法实现，需要调节。决策搜索中应当对不同的因素加权，如近处，重点，边角的权重相对较高，空旷区域权重相对较低。</li><li>规划算法：枚举搜索，优化，图优化。</li><li>差速问题需要保障。防止打滑差速机构。</li><li>有差轮运动模型。可以考虑将左右轮速度作为变量进行求解。正是。将运动模型作为约束求解。</li><li>电机响应问题，如何解决？引入超前控制，将控制器量提前提高响应速度。自适应超前控制，考虑到机器人不同负载下，速度，转弯的响应不同，最好能够将超前控制参数反馈调节。</li><li>将惩罚项变作了反向优化项，尤其是在于惩罚项附近。这也是两个相邻障碍物会导致从中间穿过的愿意。避免错误优化逻辑的发生！</li><li>对于等号约束，可以通过变换变量的方式，将优化问题映射到无约束域，如圆约束转换为角度，x^2等方式。</li><li>非线性的约束可以添加在edge的添加时，图的构建时。</li><li>评估函数，综合性的评估，更优美的方式。</li><li>必须使能伦移类homotopy的优化选项，一旦使能热启动，由于初始化位姿本身处于局部最优解，容易导致系统始终陷入局部最优。若禁用热启动，则规划代价上升。</li><li>edge定义中没有使能雅克比矩阵的求解。若定义则能显著减少CPU占用。</li><li>速度解算中，解算的是位姿速度而不是两轮速度。优化约束中约束的同样是位姿速度而不是轮速度。倘若要进一步提高稳定性，减小对移动的影响，则可以添加对两轮速度的约束。同时，机器人移动速度的解算存在的问题是位姿速度难以准确测量，车轮转速较准确。</li><li>目前teb的规划区域仅有2x2m2，因此一般考虑将teb作为速度优化器，在短距离内规划处更加平滑的路径。</li><li>存在的显著问题，需要将costmap转化为obstacle。一则效果不好，二则计算量大。考虑SVM的思想，采用支持向量法求路径。或许更快。</li><li><br></li></ul><p><br></p>